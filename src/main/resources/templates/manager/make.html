<!DOCTYPE html>
<html lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
  layout:decorate="~{layout/manager_layout.html}">
  <head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    
  </head>
<body>
  <main div class="container mt-4"layout:fragment="content" >
    <h2>매장 등록</h2>
    <form th:action="@{make}" method="post" id="signup-form">
      <div class="mb-3 form-group box">
        <label for="rt_name" class="form-label">매장명</label>
        <input type="text" class="form-control" name="rt_name" id="rt_name" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="rt_name" class="form-label">지역</label>
        <input type="text" class="form-control" name="rt_reg_num" id="rt_reg_num" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="rt_name" class="form-label">장르</label>
        <select class="form-select" id="fc_num" name="fc_num" required>
          <option value="">장르 선택</option>
          <th:block th:each="fc : ${foodcategory}">
            <option th:value="${fc.fc_num}" th:text="${fc.fc_main}"></option>
          </th:block>
        </select>
      </div>
      <div class="mb-3 form-group box">
        <label for="rt_dfc_num" class="form-label">대표장르 선택</label>
        <select class="form-select" id="rt_dfc_num" name="rt_dfc_num" required>
          <option value="">장르 선택</option>
        </select>
      </div>
			<div class="mb-3 form-group box">
        <label for="rt_closed_days" class="form-label">휴점일</label>
        <input type="text" class="form-control" name="rt_closed_days" id="rt_closed_days" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="rt_price_lunch" class="form-label">점심 가격대</label>
        <input type="text" class="form-control" name="rt_price_lunch" id="r_price_lunch" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="rt_price_dinner" class="form-label">저녁 가격대</label>
        <input type="text" class="form-control" name="rt_price_dinner" id="rt_price_dinner" required>
      </div>
			<div class="mb-3 form-group box">
        <label  class="form-label">대표 이미지(여러장? 가능)</label>
        <input type="file" class="form-control" name="fileList">
      </div>
      <button type="submit" class="btn btn-success w-100">매장 등록 하기</button>
    </form>
  </main>

  <script th:inline="javascript">
    // 서버에서 전달한 소분류 목록
    const detailFoodList = [[${dfc}]];

    document.getElementById('fc_num').addEventListener('change', function () {
      const selectedFcNum = this.value;
      const dfcSelect = document.getElementById('rt_dfc_num');

      // 기존 옵션 초기화
      dfcSelect.innerHTML = '<option value="">소분류 선택</option>';

      if (!selectedFcNum) return;

      // 선택된 대분류에 해당하는 소분류만 필터링해서 옵션 추가
      detailFoodList
        .filter(dfc => dfc.dfc_fc_num == selectedFcNum)
        .forEach(dfc => {
          const option = document.createElement('option');
          option.value = dfc.dfc_num;
          option.textContent = dfc.dfc_sub;
          dfcSelect.appendChild(option);
        });
    });
  </script>

</body>
</html>
