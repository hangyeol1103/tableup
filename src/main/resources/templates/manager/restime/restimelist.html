<!DOCTYPE html>
<html lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/manager_layout.html}">
<head>
  <meta charset="UTF-8">
  <title>ì˜ˆì•½ ê°€ëŠ¥ì‹œê°„ ë‹¬ë ¥ ë³´ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS (ìˆë‹¤ë©´ skip) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap JS (í•„ìˆ˜) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <style>
    .calendar-cell {
      width: 120px;
      height: 100px;
      border: 1px solid #ccc;
      margin: 5px;
      padding: 5px;
      display: inline-block;
      vertical-align: top;
      position: relative;
      cursor: pointer;
    }
    .calendar-row {
      display: flex;
    }
    .calendar-month {
      margin-bottom: 2rem;
    }
    .calendar-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    .opertime-info {
      font-size: 0.8em;
      margin-top: 5px;
    }
    .calendar-cell.has-reservations {
      background-color: #eaf4ff;
    }
  </style>
</head>
<body>
<main class="container mt-4" layout:fragment="content">
  <h2>ì˜ˆì•½ ì‹œê°„ ë‹¬ë ¥</h2>
  <input type="hidden" id="rtNum" th:value="${rt_num}">
  <div class="calendar-navigation">
    <button id="prevMonth" class="btn btn-outline-primary">ì´ì „ë‹¬</button>
    <span id="calendarTitle" class="fw-bold"></span>
    <button id="nextMonth" class="btn btn-outline-primary">ë‹¤ìŒë‹¬</button>
  </div>
  <button class="btn btn-outline-primary mb-3" id="openTemplateApply">ì˜ì—…ì¼ìì— ì˜ˆì•½ì‹œê°„ ì¶”ê°€</button>
  <div id="calendar"></div>
   <!-- ë‚ ì§œ í´ë¦­ ì‹œ ëœ¨ëŠ” ëª¨ë‹¬ ì°½ -->
  <div class="modal fade" id="dateModal" tabindex="-1" aria-labelledby="dateModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="dateModalLabel">
            <strong id="selectedDate">-</strong>ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
        </div>
        <div class="modal-body" id="modalBody">
            
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" id="deleteAllTimesForDateBtn">ì˜ˆì•½ì‹œê°„ ì „ì²´ ì‚­ì œ</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ìˆ˜ì •ìš© ëª¨ë‹¬ -->
  <div class="modal fade" id="editTimeModal" tabindex="-1" aria-labelledby="editTimeModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="editTimeForm">
          <div class="modal-header">
            <h5 class="modal-title" id="editTimeModalLabel">ì˜ˆì•½ ì‹œê°„ ìˆ˜ì •</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" name="bh_num">
            <input type="hidden" name="bh_date">
            <div class="mb-3">
              <label for="bh_start" class="form-label">ì‹œì‘ ì‹œê°„</label>
              <input type="time" class="form-control" name="bh_start" required>
            </div>

            <div class="mb-3">
              <label for="bh_end" class="form-label">ì¢…ë£Œ ì‹œê°„</label>
              <input type="time" class="form-control" name="bh_end" required>
            </div>

            <div class="mb-3">
              <label for="bh_seat_max" class="form-label">ìµœëŒ€ ì¢Œì„ ìˆ˜</label>
              <input type="number" class="form-control" name="bh_seat_max" min="0" required>
            </div>

            <div class="mb-3">
              <label for="bh_table_max" class="form-label">ìµœëŒ€ í…Œì´ë¸” ìˆ˜</label>
              <input type="number" class="form-control" name="bh_table_max" min="0">
            </div>
          </div>

          <div class="mb-3">
            <label for="bh_state" class="form-label">ë§ˆê° ì—¬ë¶€</label>
            <select class="form-select" name="bh_state" id="bh_state" required>
              <option value="false">ì—´ë¦¼</option>
              <option value="true">ë‹«í˜</option>
            </select>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
            <button type="button" class="btn btn-danger" id="deleteTimeBtn">ì‚­ì œ</button>
            <button type="submit" class="btn btn-primary">ë³€ê²½ í•˜ê¸°</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ëª¨ë‹¬ì°½: í…œí”Œë¦¿ ì¼ê´„ ë“±ë¡ -->
  <div class="modal fade" id="templateApplyModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">ì˜ˆì•½ í…œí”Œë¦¿ ë“±ë¡</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label>ì ìš©í•  ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”:</label>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-outline-primary" data-day="ì›”">ì›”</button>
              <button type="button" class="btn btn-outline-primary" data-day="í™”">í™”</button>
              <button type="button" class="btn btn-outline-primary" data-day="ìˆ˜">ìˆ˜</button>
              <button type="button" class="btn btn-outline-primary" data-day="ëª©">ëª©</button>
              <button type="button" class="btn btn-outline-primary" data-day="ê¸ˆ">ê¸ˆ</button>
              <button type="button" class="btn btn-outline-primary" data-day="í† ">í† </button>
              <button type="button" class="btn btn-outline-primary" data-day="ì¼">ì¼</button>
            </div>
          </div>
          <div class="mb-3">
            <label>í•´ë‹¹ ìš”ì¼ì˜ í…œí”Œë¦¿:</label>
            <div id="templatePreviewArea" class="border p-2" style="max-height: 200px; overflow-y: auto;"></div>
          </div>
          <div class="mb-3">
            <label>ì¤‘ë³µëœ ë‚ ì§œ ì²˜ë¦¬:</label><br>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="overwrite" id="overwriteTrue" value="true">
              <label class="form-check-label" for="overwriteTrue">ë®ì–´ì“°ê¸°</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="overwrite" id="overwriteFalse" value="false" checked>
              <label class="form-check-label" for="overwriteFalse">ë¬´ì‹œí•˜ê¸°</label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
          <button type="button" class="btn btn-primary" id="applyTemplateBtn">í…œí”Œë¦¿ ì ìš©</button>
        </div>
      </div>
    </div>
  </div>

  <!-- <button type="button" class="btn btn-outline-success col-12 mb-3" onclick="location.href='/manager/restime/make_restime'">ì˜ˆì•½ ì‹œê°„ ë“±ë¡</button> -->
  <!-- <a th:href="@{/manager/restaurant/restaurant/{rm_id}(rm_id=${manager.rm_id})}" id="goBackToManager" class="btn btn-outline-secondary col-12 mb-3">ë§¤ì¥ ê´€ë¦¬ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a> -->
   <a th:href="@{/manager/restime/restimepage}" class="btn btn-outline-secondary col-12 mt-4">ì˜ˆì•½ ê´€ë¦¬ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>

  <script th:inline="javascript">
    const today = new Date();
    let currentMonth = today.getMonth();
    let currentYear = today.getFullYear();
    let selectedDay = null;
    let overwrite = false;

    const dayMap = { 'ì¼': 0, 'ì›”': 1, 'í™”': 2, 'ìˆ˜': 3, 'ëª©': 4, 'ê¸ˆ': 5, 'í† ': 6 };
    const rtNum = document.getElementById('rtNum')?.value;

    console.log("rtNum : ", rtNum);

    const opertimelist = /*[[${opertimelist}]]*/ [];
    const restimelist = /*[[${restimelist}]]*/ [];
    const templateList = /*[[${templateList}]]*/ [];

    // ì‚­ì œìš© ë³€ìˆ˜
    let deletedBhNum=null;


    console.log("ì €ì¥ëœ ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ : ",restimelist);

    function renderCalendar(year, month) {
      localStorage.setItem('lastViewedYear', year);
      localStorage.setItem('lastViewedMonth', month);
      $('#calendar').empty();
      const container = $('<div class="calendar-month"></div>');
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const firstDay = new Date(year, month, 1).getDay();
      
      $('#calendarTitle').text(`${year}ë…„ ${month + 1}ì›”`);
      const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
      let row = $('<div class="calendar-row"></div>');
      weekdays.forEach(day => row.append(`<div class="calendar-cell"><strong>${day}</strong></div>`));
      container.append(row);

      row = $('<div class="calendar-row"></div>');
      for (let i = 0; i < firstDay; i++) row.append('<div class="calendar-cell"></div>');

      for (let i = 1; i <= daysInMonth; i++) {
        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
        const match = opertimelist.find(op => op.bd_date === dateStr);

        const res = restimelist
          .filter(res => res.bh_start?.substring(0,10) === dateStr)
          .map(res => res.bh_start?.substring(11,16))
          .sort();

        const maxDisplay = 2;
        const displayedTimes = res.slice(0, maxDisplay);
        const hiddenCount = res.length - maxDisplay;

        const cell = $(`
          <div class="calendar-cell" data-date="${dateStr}">
            <strong>${i}</strong>
            ${match ? `
              <div class="opertime-info">
                ${match.bd_open || '-'} ~ ${match.bd_close || '-'}<br>
                ${match.bd_off ? 'ì‰¬ëŠ”ë‚ ' : 'ì—¬ëŠ”ë‚ '}
              </div>` : ''
            }
            ${displayedTimes.length > 0 ? `
              <div class="opertime-info text-primary mt-1">
                <strong>ì˜ˆì•½:</strong><br>
                ${displayedTimes.join(', ')}${
                  hiddenCount > 0 ? `, <span class="more-btn text-decoration-underline text-primary" style="cursor:pointer" data-date="${dateStr}">+ì™¸ ${hiddenCount}ê±´</span>` : ''
                }
              </div>` : ''
            }
          </div>
        `);

        if (res.length > 0) {
          cell.addClass('has-reservations');
        }

        cell.click(() => {
          showTimeModal(dateStr);
        });

        row.append(cell);
        if ((firstDay + i) % 7 === 0) {
          container.append(row);
          row = $('<div class="calendar-row"></div>');
        }
      }
      container.append(row);
      $('#calendar').append(container);
    }

    $('#prevMonth').click(() => {
      currentMonth--;
      if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      renderCalendar(currentYear, currentMonth);
    });

    $('#nextMonth').click(() => {
      currentMonth++;
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      }
      renderCalendar(currentYear, currentMonth);
    });

    $(document).ready(() => {
      
      //ì €ì¥ëœ ë‹¬ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
      const reload = localStorage.getItem('reload');
      const savedYear = reload?localStorage.getItem('lastViewedYear') : new Date().getFullYear();
      const savedMonth = reload?localStorage.getItem('lastViewedMonth') : new Date().getMonth();
      localStorage.removeItem('reload');
      if (savedYear && savedMonth) {
        currentYear = parseInt(savedYear);
        currentMonth = parseInt(savedMonth);
      }

      renderCalendar(currentYear, currentMonth);

      // ëª¨ë‹¬ ë‹«í ë•Œ ì •ë¦¬
      document.addEventListener('hidden.bs.modal', function () {
        document.body.classList.remove('modal-open');
        document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
      });
      //í…œí”Œë¦¿ ì¶”ê°€ ì´ë²¤íŠ¸
      $('#openTemplateApply').click(() => new bootstrap.Modal($('#templateApplyModal')).show());
      $('#templateApplyModal button[data-day]').click(function () {
        selectedDay = $(this).data('day');

        // ë²„íŠ¼ ì‹œê°ì ìœ¼ë¡œ í™œì„±í™” í‘œì‹œ
        $('#templateApplyModal button[data-day]').removeClass('active');
        $(this).addClass('active');

        // ì„ íƒí•œ ìš”ì¼ì˜ í…œí”Œë¦¿ í•„í„°ë§
        const templates = templateList.filter(t => t.bhd_date === selectedDay);

        // ì¶œë ¥í•  ì˜ì—­
        const previewArea = $('#templatePreviewArea');
        previewArea.empty();

        if (templates.length === 0) {
          previewArea.append(`<p class="text-muted">ë“±ë¡ëœ í…œí”Œë¦¿ì´ ì—†ìŠµë‹ˆë‹¤.</p>`);
        } else {
          templates.forEach(t => {
            previewArea.append(`
              <div class="mb-1">
                â° ${t.bhd_timeStart} ~ ${t.bhd_timeEnd} | ì¢Œì„: ${t.bhd_seat} | í…Œì´ë¸”: ${t.bhd_table}
              </div>
            `);
          });
        }
      });
      //ìš”ì¼ ì˜ˆì•½ ì‹œê°„ ì „ì²´ ì‚­ì œë²„íŠ¼ 
      $('#deleteAllTimesForDateBtn').click(() => {
        const date = $('#selectedDate').text(); // yyyy-MM-dd

        if (!confirm(`${date}ì˜ ëª¨ë“  ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

        $.ajax({
          url: '/manager/restime/delete_by_date',
          type: 'POST',
          contentType: 'application/json',
          data: JSON.stringify({ rt_num: rtNum, date }),
          success: () => {
            alert("í•´ë‹¹ ë‚ ì§œì˜ ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
            $('#dateModal').modal('hide');
            // $.get('/manager/restime/restimelist_json/' + rtNum, function(data) {
            //   restimelist = data;
            //   renderCalendar(currentYear, currentMonth);
            // });
            location.reload();
          },
          error: (xhr) => {
            console.error(xhr.responseText);
            alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ");
          }
        });
      });
      console.log("overwrite : ", overwrite);
      $('input[name="overwrite"]').change(function () {
        overwrite = $(this).val() === 'true';
      });
      $('#applyTemplateBtn').click(applyTemplateToBusinessDates);

      // ë³€ê²½ ë²„íŠ¼ ì´ë²¤íŠ¸
      $('#editTimeForm').submit(function(e){
        e.preventDefault();
        const bh_date = $(this).find('input[name="bh_date"]').val(); // yyyy-MM-dd
        const bh_start_time = $(this).find('input[name="bh_start"]').val(); // HH:mm
        const bh_end_time = $(this).find('input[name="bh_end"]').val(); // HH:mm

        const data = {
          bh_num: parseInt($(this).find('input[name="bh_num"]').val(), 10),
          bh_date: bh_date,
          bh_start: bh_date + 'T' + bh_start_time,
          bh_end: bh_date + 'T' + bh_end_time,
          bh_seat_max: parseInt($(this).find('input[name="bh_seat_max"]').val(), 10),
          bh_table_max: parseInt($(this).find('input[name="bh_table_max"]').val(), 10),
          bh_state: parseInt($(this).find('select[name="bh_state"]').val(), 10)
        };
        
        console.log("ë³´ë‚¼ ë°ì´í„° : ", data);

        $.ajax({
          async : true,
          url : '/manager/restime/remake_restime', 
          type : 'post',
          contentType: 'application/json', 
          data : 	JSON.stringify(data),
          success : function (){
            alert('ìˆ˜ì • ì™„ë£Œ');
            $('#editTimeModal').modal('hide')
            $.get('/manager/restime/restimelist_json/' + rtNum, function(data) {
              restimelist = data;
              renderCalendar(currentYear, currentMonth);
            }); 
          }, 
          error : function(){
            alert("ë³€ê²½ì— ì˜¤ë¥˜ê°€ ìƒê²¼ìŠµë‹ˆë‹¤.")
          }
        });
      });
      //ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸
      $('#deleteTimeBtn').click(()=>{
        if(!deletedBhNum){
          return;
        }
        if(!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){
          return;
        }
        $.ajax({
          async : true,
          url : '/manager/restime/delete_restime/' + deletedBhNum, 
          type : 'post', 
          success : function (data){
             $('#editTimeModal').modal('hide');
             $.get('/manager/restime/restimelist_json/' + rtNum, function(data) {
              restimelist = data;
              renderCalendar(currentYear, currentMonth);
            });
          }, 
          error : function(){
            alert("ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
          }
        });
      })
      $(document).on('click', '.more-btn', function() {
        const date = $(this).data('date');
        showTimeModal(date); // ê¸°ì¡´ í•¨ìˆ˜ ì¬ì‚¬ìš©
      });

      $('#goBackToManager').click(function () {
        localStorage.removeItem('lastViewedYear');
        localStorage.removeItem('lastViewedMonth');
      });
    });

    function showTimeModal(dateStr) {
      $('#selectedDate').text(dateStr); // ëª¨ë‹¬ ì œëª© ë‚ ì§œ ì„¤ì •
      const times = restimelist
        .filter(res => res.bh_start?.substring(0,10) === dateStr)
        .sort((a, b) => a.bh_start.localeCompare(b.bh_start));

      const modalBody = $('#modalBody');
      modalBody.empty();

      if (times.length === 0) {
        modalBody.append('<p>ì˜ˆì•½ ê°€ëŠ¥í•œ ì‹œê°„ì´ ì—†ìŠµë‹ˆë‹¤.</p>');
      } else {
        times.forEach(item => {
          const timeStr = item.bh_start.substring(11, 16);
          const btn = $(`<button class="btn btn-outline-primary mb-2 me-2">${timeStr}</button>`);
          // btn.click(() => {
          //   location.href = `/manager/restime/remake_restime/${item.bh_num}`; // ìˆ˜ì • í˜ì´ì§€ë¡œ ì´ë™
          // });

          btn.click(() => {

            const bhDate = item.bh_start.substring(0, 10);  // â† ì—¬ê¸°ì„œ ë‚ ì§œ ì¶”ì¶œ
            const bhStart = item.bh_start.substring(11, 16);
            const bhEnd = item.bh_end.substring(11, 16);

            $('#editTimeModal').modal('show');  // ìˆ˜ì •ìš© ëª¨ë‹¬
            $('#editTimeModal input[name="bh_num"]').val(item.bh_num);
            $('#editTimeModal input[name="bh_date"]').val(bhDate);
            $('#editTimeModal input[name="bh_start"]').val(bhStart);
            $('#editTimeModal input[name="bh_end"]').val(bhEnd);
            $('#editTimeModal input[name="bh_seat_max"]').val(item.bh_seat_max);
            $('#editTimeModal input[name="bh_table_max"]').val(item.bh_table_max);
            $('#editTimeModal input[name="bh_state"]').val(item.bh_state);
            
            deletedBhNum =item.bh_num;  //ì‚­ì œìš© ID ì €ì¥

            console.log("deletedBhNum : ", deletedBhNum);
            console.log("item: ", item);
            $('#editTimeModal').modal('show');
          });
          modalBody.append(btn);
        });
      }

      const modal = new bootstrap.Modal(document.getElementById('dateModal'));
      modal.show();
    }
    function applyTemplateToBusinessDates() {
      if (!selectedDay) {
        alert("ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”");
        return;
      }

      const resultList = [];

      opertimelist.forEach(bd => {
        const date = new Date(bd.bd_date);

        if (date.getDay() === dayMap[selectedDay]) {
          const existTimes = restimelist.filter(rt => rt.bh_start?.startsWith(bd.bd_date));
          if (!overwrite && existTimes.length > 0) return;

          const templateTimes = templateList.filter(t => t.bhd_date === selectedDay);
          templateTimes.forEach(t => {
            const dateOnly = bd.bd_date.substring(0, 10); // "yyyy-MM-dd"
            
            // hh:mm:ss ë³´ì¥
            const start = t.bhd_timeStart.length === 5 ? `${t.bhd_timeStart}:00` : t.bhd_timeStart;
            const end = t.bhd_timeEnd.length === 5 ? `${t.bhd_timeEnd}:00` : t.bhd_timeEnd;

            resultList.push({
              bh_date: bd.bd_date,
              bh_start: `${dateOnly} ${start}`,
              bh_end: `${dateOnly} ${end}`,
              bh_seat_max: t.bhd_seat,
              bh_table_max: t.bhd_table,
              bh_rt_num: t.bhd_rt_num,

              bh_start_ts: `${dateOnly}T${start}`,  // ì˜ˆ: 2025-06-23T12:00:00
              bh_end_ts: `${dateOnly}T${end}`
            });
          });
        }
      });

      if (resultList.length === 0) {
        alert("ì ìš©í•  í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }

      // ğŸ’¡ ì „ì†¡ ì§ì „ ë¡œê·¸ í™•ì¸ìš©
      console.log("ì „ì†¡ ë°ì´í„°:", JSON.stringify(resultList, null, 2));
      // ì¤‘ë³µ ì—¬ë¶€
      console.log("overwrite : ", overwrite);

      $.ajax({
        url: '/manager/restime/make_restime_list',
        method: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({
          overwrite: overwrite,
          list : resultList}),
        success: () => {
          alert("ì˜ˆì•½ ê°€ëŠ¥ ì‹œê°„ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
          localStorage.setItem("reload", true);
          location.reload();
        },
        error: (xhr) => {
          console.error("ì „ì†¡ ì‹¤íŒ¨:", xhr.responseText);
          alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      });
    }

  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.addEventListener('hidden.bs.modal', function () {
        document.body.classList.remove('modal-open');
        document.querySelectorAll('.modal-backdrop').forEach(e => e.remove());
      });
    });
  </script>
</main>
</body>
</html>
