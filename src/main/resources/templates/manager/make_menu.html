<!DOCTYPE html>
<html lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
  layout:decorate="~{layout/manager_layout.html}">
  <head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
   
    <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs5.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs5.min.js"></script>

    
  </head>
<body>
  <main div class="container mt-4"layout:fragment="content" >
    <h2>메뉴 등록</h2>
    <form th:action="@{make_menu}" method="post" id="signup-form" enctype="multipart/form-data">
      <div class="mb-3 form-group box">
        <label for="mn_name" class="form-label">메뉴이름</label>
        <input type="text" class="form-control" name="mn_name" id="mn_name" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="mt_num" class="form-label">메뉴분류</label>
        <select class="form-select" id="mt_num" name="mt_num" required>
          <option value="">분류선택</option>
          <th:block th:each="menutype : ${menutype}">
            <option th:value="${menutype.mt_num}" th:text="${menutype.mt_name}"></option>
          </th:block>
        </select> 
      </div>
      <div class="mb-3 form-group box">
        <label for="mn_img" class="form-label">메뉴사진</label>
        <input type="file" class="form-control" name="mn_img" id="mn_img" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="mn_price" class="form-label">메뉴가격</label>
        <input type="text" class="form-control" name="mn_price" id="mn_price" required>
      </div>
			<div class="mb-3 form-group box">
        <label for="mn_content" class="form-label">메뉴설명</label>
        <input type="text" class="form-control" name="mn_content" id="mn_content" required>
      </div>
      <div class="mb-3 form-group box">
        <label for="mn_div" class="form-label">메뉴색인</label>
        <input type="text" class="form-control" name="mn_div" id="mn_div" required>
      </div>
      <button type="submit" class="btn btn-success w-100">메뉴 등록</button>
    </form>

    <script>
      $(document).ready(function(){
        $('#rt_description').summernote({
          placeholder: '매장 설명을 입력하세요.',
          tabsize: 2,
          height: 400
        });
      });
    </script>

    <!--상세지역(ex.강남, 서초, 동작, ....) 선택 스크립트-->
    <script>
      $(document).ready(function () {
        $('#reg_num').on('change', function () {
          
          const selectedRegNum = $(this).val();
          const $drSelect = $('#dreg_reg_num');       

          $drSelect.empty();
          $drSelect.append('<option value="">상세지역을 선택하세요.</option>');

          if (!selectedRegNum) return;

          // Ajax 요청
          $.ajax({
            async : true,
            url: '/manager/get-detailregion',
            method: 'get',
            data: { regNum: selectedRegNum },
            success: function (data) {
              console.log($('#dreg_reg_num').val());
              data.forEach(function (dr) {
                const option = $('<option></option>')
                  .val(dr.dreg_num)
                  .text(dr.dreg_sub);
                $drSelect.append(option);
              });
            },
            error: function () {
              alert('상세지역을 가져오는데 실패하였습니다.');
            }
          });
        });
      });
    </script>

    <!--대표음식(ex.스테이크, 회, 돈가츠, ....) 선택 스크립트-->
    <script>
      $(document).ready(function () {
        $('#fc_num').on('change', function () {
          const selectedFcNum = $(this).val();
          const $dfcSelect = $('#dfc_fc_num');       

          $dfcSelect.empty();
          $dfcSelect.append('<option value="">대표음식을 선택하세요.</option>');

          if (!selectedFcNum) return;

          // Ajax 요청
          $.ajax({
            async : true,
            url: '/manager/get-detail',
            method: 'get',
            data: { fcNum: selectedFcNum },
            success: function (data) {
              console.log($('#dfc_fc_num').val());
              data.forEach(function (dfc) {
                const option = $('<option></option>')
                  .val(dfc.dfc_num)
                  .text(dfc.dfc_sub);
                $dfcSelect.append(option);
              });
            },
            error: function () {
              alert('대표음식을 가져오는데 실패하였습니다.');
            }
          });
        });
      });
    </script>
  </main>
  


</body>
</html>
